import{$a as V,Aa as n,Ab as W,Ba as h,Bb as j,Ca as C,Cb as c,Da as g,Db as H,Ea as A,Eb as Q,Fa as D,Ga as F,Ha as E,Ia as M,Ja as I,Ka as b,M as S,Ma as R,Na as B,Oa as N,Pa as T,Q as y,Qa as U,Ra as O,W as f,X as p,bb as G,fb as L,gb as K,ia as d,la as P,pa as _,q as v,sa as k,ub as x,vb as z}from"./chunk-QZ77J6FG.js";var $="https://localhost:7104/api/Products/from-wsdl",m=class a{constructor(t){this.http=t}getProducts(t,e,i,r){let{claveBodega:o=1,claveCompania:l=1,idioma:Y=2058,forceRefresh:J=!1}=r??{},u=new L().set("claveBodega",String(o)).set("claveCompania",String(l)).set("idioma",String(Y)).set("page",String(t)).set("pageSize",String(e)).set("forceRefresh",String(J));return i&&i.trim()&&(u=u.set("search",i.trim())),this.http.get($,{params:u}).pipe(v(s=>{let w=Array.isArray(s?.items)?s.items:[],X=typeof s?.total=="number"?s.total:w.length;return{data:w,total:X}}))}static \u0275fac=function(e){return new(e||a)(y(K))};static \u0275prov=S({token:a,factory:a.\u0275fac,providedIn:"root"})};var te=()=>({enabled:!0,mode:"multiple",checkboxOnly:!0});function ie(a,t){if(a&1&&g(0,"kendo-grid-column",7),a&2){let e=t.$implicit;n("field",e.field)("title",e.title)("width",e.width??150)("filter",e.filter||"text")("headerClass",e.headerClass||"")}}function oe(a,t){if(a&1&&b(0),a&2){let e=t.total,i=t.skip,r=t.pageSize,o=F();B(" Mostrando ",i+1," - ",o.min(i+r,e)," de ",e," productos ")}}var ae=1,re=1,le=2058,ne=!1,q=class a{constructor(t){this.srv=t}grid;state={skip:0,take:50,filter:void 0,sort:[]};gridView={data:[],total:0};selectedKeys=[];scrollable="scrollable";min(t,e){return Math.min(t,e)}allColumns=[{field:"claveBodega",title:"Clave bodega",width:150},{field:"nombreBodega",title:"Nombre bodega",width:200},{field:"claveCompania",title:"Clave compa\xF1\xEDa",width:150},{field:"nombreCompania",title:"Nombre compa\xF1\xEDa",width:220},{field:"claveProducto",title:"Clave producto",width:160},{field:"nombre",title:"Nombre producto",width:260},{field:"claveTipoProducto",title:"Clave tipo producto",width:180},{field:"nombreTipoProducto",title:"Nombre tipo producto",width:220},{field:"claveUnidadProducto",title:"Clave unidad producto",width:200},{field:"unidadEntradaUP",title:"UM Entrada",width:140},{field:"unidadAlmacenUP",title:"UM Almac\xE9n",width:140},{field:"unidadSalidaUP",title:"UM Salida",width:140},{field:"claveCaducidad",title:"Clave caducidad",width:160},{field:"dias_Caducidad",title:"D\xEDas caducidad",width:150,filter:"numeric"},{field:"claveCriterio",title:"Clave criterio",width:150},{field:"nombreCriterio",title:"Nombre criterio",width:200},{field:"claveCriterioAbc",title:"Clave criterio ABC",width:180},{field:"nombreCriterioAbc",title:"Nombre criterio ABC",width:210},{field:"costoUnitario",title:"Costo unitario",width:160,filter:"numeric"},{field:"costoAlmacen",title:"Costo almac\xE9n",width:160,filter:"numeric"},{field:"claveRotacion",title:"Clave rotaci\xF3n",width:150},{field:"nombreRotacion",title:"Nombre rotaci\xF3n",width:180},{field:"fechaUltCont",title:"Fecha \xFAltimo conteo",width:190,filter:"date"},{field:"peso",title:"Peso",width:120,filter:"numeric"},{field:"volumen",title:"Volumen",width:120,filter:"numeric"},{field:"largo",title:"Largo",width:120,filter:"numeric"},{field:"ancho",title:"Ancho",width:120,filter:"numeric"},{field:"alto",title:"Alto",width:120,filter:"numeric"},{field:"contador",title:"Contador",width:140},{field:"calificador",title:"Calificador",width:140},{field:"ean13",title:"EAN13",width:160},{field:"upc128",title:"UPC128",width:160},{field:"centralPesadas",title:"Central pesadas",width:160,filter:"boolean"},{field:"etiqueta",title:"Etiqueta",width:140,filter:"boolean"},{field:"surtido",title:"D\xEDas exceso surtido",width:190,filter:"numeric"},{field:"controlCaja",title:"Control caja",width:150,filter:"boolean"},{field:"localizacion",title:"Localizaci\xF3n",width:180},{field:"leyenda",title:"Leyenda",width:220},{field:"certificado",title:"Certificado",width:150,filter:"boolean"},{field:"asignarLote",title:"Asignar lote",width:150,filter:"boolean"},{field:"nombreAsignarLoteProducto",title:"Nombre asignar lote",width:220},{field:"sePesaAlEntrar",title:"Se pesa al entrar",width:180,filter:"boolean"},{field:"sePesaAlSalir",title:"Se pesa al salir",width:170,filter:"boolean"},{field:"sePesaEnCp",title:"Se pesa en CP",width:160,filter:"boolean"},{field:"sePesaEnProduccion",title:"Se pesa en producci\xF3n",width:200,filter:"boolean"},{field:"sePesaEnFabricacion",title:"Se pesa en fabricaci\xF3n",width:210,filter:"boolean"},{field:"consumo",title:"Consumo",width:160},{field:"descripcionTipoConsumoProducto",title:"Descripci\xF3n tipo consumo",width:240},{field:"ordenSurtidoId",title:"Orden de surtido",width:170,filter:"numeric"},{field:"descripcionOrdenSurtido",title:"Descripci\xF3n orden de surtido",width:240},{field:"claveMarca",title:"Clave marca",width:150},{field:"nombreMarca",title:"Nombre marca",width:180}];get visibleColumns(){return this.allColumns.filter(t=>!t.hidden)}ngOnInit(){this.refreshScrollMode(),this.loadData()}ngAfterViewInit(){setTimeout(()=>this.autoFitColumns(),0)}dataStateChange(t){this.state=t,this.loadData()}loadData(){let t=this.state.skip??0,e=this.state.take&&this.state.take>0?this.state.take:50,i=Math.floor(t/e)+1,r=this.extractSearch(this.state.filter);this.srv.getProducts(i,e,r,{claveBodega:ae,claveCompania:re,idioma:le,forceRefresh:ne}).subscribe({next:o=>{this.gridView={data:o.data,total:o.total},setTimeout(()=>this.autoFitColumns(),0)}})}extractSearch(t){if(!t)return;let e=o=>(o.filters??[]).flatMap(l=>"filters"in l?e(l):[l]);return e(t).find(o=>o.field==="claveProducto"||o.field==="nombre")?.value?.toString()}autoFitColumns(){if(this.grid)try{if(this.visibleColumns.length<=15){this.scrollable="none";let t=this.grid.columns?.toArray?.()??[];t.length&&this.grid.autoFitColumns&&this.grid.autoFitColumns(t)}else this.scrollable="scrollable"}catch{}}refreshScrollMode(){this.scrollable=this.visibleColumns.length<=15?"none":"scrollable"}static \u0275fac=function(e){return new(e||a)(P(m))};static \u0275cmp=_({type:a,selectors:[["app-product-catalog"]],viewQuery:function(e,i){if(e&1&&E(c,5),e&2){let r;M(r=I())&&(i.grid=r.first)}},decls:8,vars:18,consts:[["grid",""],[1,"flex","items-center","gap-2","mb-2"],["kendoButton","",3,"primary","disabled"],[2,"height","calc(100vh - 220px)",3,"selectedKeysChange","dataStateChange","data","skip","pageSize","sortable","filterable","resizable","reorderable","pageable","scrollable","kendoGridSelectBy","selectedKeys","selectable"],["title","Borrar",3,"width"],[3,"field","title","width","filter","headerClass",4,"ngFor","ngForOf"],["kendoPagerInfoTemplate",""],[3,"field","title","width","filter","headerClass"]],template:function(e,i){if(e&1){let r=A();h(0,"div",1)(1,"button",2),b(2),C()(),h(3,"kendo-grid",3,0),U("selectedKeysChange",function(l){return f(r),T(i.selectedKeys,l)||(i.selectedKeys=l),p(l)}),D("dataStateChange",function(l){return f(r),p(i.dataStateChange(l))}),g(5,"kendo-grid-checkbox-column",4),k(6,ie,1,5,"kendo-grid-column",5)(7,oe,1,3,"ng-template",6),C()}e&2&&(d(),n("primary",!0)("disabled",!i.selectedKeys.length),d(),R(" Eliminar seleccionados (",i.selectedKeys.length,") "),d(),n("data",i.gridView)("skip",i.state.skip)("pageSize",i.state.take)("sortable",!0)("filterable",!0)("resizable",!0)("reorderable",!0)("pageable",!0)("scrollable",i.scrollable)("kendoGridSelectBy","claveProducto"),N("selectedKeys",i.selectedKeys),n("selectable",O(17,te)),d(2),n("width",50),d(),n("ngForOf",i.visibleColumns))},dependencies:[G,V,Q,c,H,W,j,z,x],encapsulation:2})};export{q as ProductCatalogComponent};
